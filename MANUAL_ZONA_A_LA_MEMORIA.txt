üèõÔ∏è ZONA A: LA MEMORIA (THE VAULT)
Registro de la Arquitectura Sagrada del Universo Titanium.

--------------------------------------------------------------------------------
1. LA B√ìVEDA (The Vault)
La Promesa: El dominio absoluto sobre tu creaci√≥n; un √≠ndice vivo que respira al ritmo de tu Drive y separa la Verdad (Canon) de la Inspiraci√≥n (Recursos).

Mec√°nica Sagrada (C√≥mo se usa):
1. Navegaci√≥n: Despliega el √°rbol de archivos. Observar√°s dos grandes divisiones: CANON (La Verdad de tu historia) y RECURSOS (Material de referencia).
2. Filtrado de Sagas: Usa el selector superior ("Vista Global") para aislar una Saga espec√≠fica y ocultar el ruido irrelevante.
3. Gesti√≥n de Archivos:
    ‚ó¶ Un Clic: Selecciona y abre el archivo en el Editor H√≠brido.
    ‚ó¶ Doble Clic: Invoca el ritual de Renombramiento (permite editar el nombre del archivo o carpeta directamente en Drive).
4. La Chispa: Si te sientes perdido, pulsa el bot√≥n "¬øTienes una Chispa?" para invocar al Protocolo G√©nesis.

La Magia Oculta (Lo T√©cnico): Bajo la superficie, VaultSidebar.tsx no es un simple explorador. Escucha en tiempo real (v√≠a onSnapshot) la colecci√≥n TDB_Index de Firestore.
‚Ä¢ Split Logic: El c√≥digo intercepta tu configuraci√≥n (ProjectConfigContext) y separa visualmente los IDs que pertenecen al Canon de los que son simples Recursos, aunque en Drive est√©n mezclados.
‚Ä¢ Sentinel Filter: Si un archivo tiene conflictos de sincronizaci√≥n (isConflicting: true), el √°rbol lo marca en √°mbar o lo oculta si el "Filtro de Salud" est√° activo.

Advertencias:
‚Ä¢ ‚ö†Ô∏è Renombramiento: Al renombrar un archivo aqu√≠, se renombra f√≠sicamente en Google Drive. No hay "Deshacer".
‚Ä¢ ‚ö†Ô∏è Latencia: Los cambios realizados directamente en Drive pueden tardar unos segundos en reflejarse si el Listener de Firestore no recibe el "latido" inmediato.

--------------------------------------------------------------------------------
2. EL ENLACE NEURAL (Neural Link)
La Promesa: La soberan√≠a de tus datos; tu mundo vive en tu Google Drive personal, no en nuestros servidores, garantizando que eres el √∫nico due√±o de tu obra.

Mec√°nica Sagrada (C√≥mo se usa):
1. Iniciaci√≥n: Al crear un proyecto o desconectarte, ver√°s el panel "Conexi√≥n Neuronal".
2. El Ritual de Enlace: Pulsa "Conectar Drive". Se abrir√° una ventana de Google.
3. El Pacto: Debes conceder permisos totales (Scope: drive.file) para que el Escriba pueda leer y escribir tus manuscritos.
4. La Perpetuidad: Una vez enlazado, el sistema renovar√° el acceso autom√°ticamente en silencio.

La Magia Oculta (Lo T√©cnico): El sistema utiliza el protocolo Google Identity Services v2 (initCodeClient) con prompt: 'consent'.
‚Ä¢ Esto fuerza la generaci√≥n de un Refresh Token de larga duraci√≥n, que el backend (exchangeAuthCode) almacena cifrado.
‚Ä¢ Una Cloud Function llamada refreshDriveToken se ejecuta peri√≥dicamente o ante errores 401, renovando el accessToken sin que tengas que volver a iniciar sesi√≥n jam√°s.

Advertencias:
‚Ä¢ ‚ö†Ô∏è Cuentas de Servicio: Si compartes carpetas manualmente, aseg√∫rate de invitar al correo del "Service Account" del sistema, o el enlace arrojar√° un error 404 (Vac√≠o).

--------------------------------------------------------------------------------
3. CONFIGURACI√ìN DEL UNIVERSO (Project Matrix)
La Promesa: Define la f√≠sica y la taxonom√≠a de tu mundo, ense√±ando a la IA qu√© es historia (Lore) y qu√© es trama (Saga), para que nunca confunda un personaje con una ciudad.

Mec√°nica Sagrada (C√≥mo se usa):
1. Acceso: Abre el men√∫ de Ajustes (icono de engranaje o carpeta) en el pie de la B√≥veda.
2. Taxonom√≠a (El Cerebro):
    ‚ó¶ Auto-Detectar: Deja que la IA escanee tus carpetas e intente adivinar qu√© es qu√©.
    ‚ó¶ Crear Est√°ndar: Si tu carpeta est√° vac√≠a, invoca la estructura "Titanium" para crear autom√°ticamente las carpetas sagradas (Mundo, Personajes, Borradores).
3. Mapeo Manual: Asigna manualmente carpetas de Drive a roles espec√≠ficos (Ej: "Carpeta X" = "Bestiario").

La Magia Oculta (Lo T√©cnico): Este panel (ProjectSettingsModal.tsx) manipula el ProjectConfig en Firestore.
‚Ä¢ Indexaci√≥n Estricta: Al guardar, el sistema dispara getDriveFiles con persist: true. Esto purga el √≠ndice antiguo y re-escanea solo las carpetas mapeadas, asegurando que la IA no "alucine" con archivos basura que no hayas autorizado expl√≠citamente.

Advertencias:
‚Ä¢ ‚ö†Ô∏è El Gran Olvido: Si desvinculas una carpeta de su rol (ej: quitas la carpeta de "Personajes"), la IA olvidar√° instant√°neamente a todos los seres que viv√≠an all√≠.

--------------------------------------------------------------------------------
4. MODO ZEN (Sentinel Shell)
La Promesa: El silencio absoluto. Un escudo cognitivo que colapsa la realidad para dejarte a solas con tus palabras.

Mec√°nica Sagrada (C√≥mo se usa):
1. Activaci√≥n: Invocado autom√°ticamente al entrar en flujo o manualmente desde la Barra de Comandos.
2. Efecto: La B√≥veda (Sidebar) y el Arsenal (Tools) se pliegan en la nada. Solo queda el Editor H√≠brido.
3. Retorno: Mueve el cursor a los bordes o presiona la tecla de invocaci√≥n para traer de vuelta la interfaz.

La Magia Oculta (Lo T√©cnico): Controlado por SentinelShell.tsx y el useLayoutStore.
‚Ä¢ No es solo CSS (display: none). El componente desmonta parcialmente los paneles pesados para liberar recursos de la memoria del navegador, manteniendo solo el n√∫cleo del editor (CodeMirror) activo para m√°xima fluidez.

Advertencias:
‚Ä¢ ‚ö†Ô∏è Ceguera Temporal: En Modo Zen, las alertas del Guardi√°n (Canon Radar) son silenciadas visualmente. Escribes bajo tu propio riesgo de continuidad.
