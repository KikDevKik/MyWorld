================================================================================
INFORME DIAGNÓSTICO: BLOQUEO DE SEGURIDAD (APP CHECK 403 / 401)
================================================================================

1. ANÁLISIS DEL PROBLEMA
--------------------------------------------------------------------------------
Los logs muestran un "BLOQUEO DE SEGURIDAD" persistente que impide la conexión con el servidor.

Error Crítico:
> "AppCheck: Requests throttled due to 403 error. Attempts allowed again after 01d:00m:00s"

¿Qué significa esto?
Tu aplicación (el cliente web) ha intentado demasiadas veces validar su identidad con Firebase (usando ReCaptcha v3) y ha fallado repetidamente. Como medida de protección, Firebase ha puesto tu IP o tu navegador en una "LISTA NEGRA TEMPORAL" por 24 horas (throttling).

Consecuencias (Efecto Dominó):
1.  El "Handshake" de seguridad falla (403 Forbidden).
2.  Al no tener el token de seguridad, el servidor rechaza cualquier otra petición (como `checkIndexStatus` o `refreshDriveToken`) con un error "401 Unauthorized".
3.  La aplicación carga, pero está desconectada de la nube ("Offline Mode").

2. HERRAMIENTAS INVOLUCRADAS (CONTEXTO TÉCNICO)
--------------------------------------------------------------------------------
Para el equipo de planificación, así funciona el sistema de seguridad actual:

A. EL GATEKEEPER (Firebase App Check):
   - Es el portero de la discoteca. Su trabajo es asegurar que quien llama a la API sea realmente tu aplicación web oficial y no un script malicioso o un bot.
   - Estado Actual: Está bloqueando la entrada porque sospecha de tráfico inusual o configuración errónea.

B. LA CREDENCIAL (ReCaptcha v3):
   - Es el DNI que presenta el usuario. ReCaptcha analiza el comportamiento del usuario en segundo plano para asegurar que es humano.
   - Estado Actual: La validación de este "DNI" ha fallado tantas veces que el sistema ha dejado de intentarlo.

C. LA BÓVEDA (Cloud Functions):
   - Son las funciones del servidor (`checkIndexStatus`, `refreshDriveToken`).
   - Estado Actual: Están configuradas para rechazar a cualquiera que no pase el control del Gatekeeper (App Check). Por eso devuelven 401.

3. SOLUCIÓN INMEDIATA (PARA DESARROLLADORES)
--------------------------------------------------------------------------------
Para desbloquear la situación y permitir que el equipo trabaje (Fail-Open), debes desactivar temporalmente la aplicación estricta de estas reglas en la consola de Firebase.

PASOS A SEGUIR EN FIREBASE CONSOLE:

1.  Ve a la Consola de Firebase: https://console.firebase.google.com/
2.  Selecciona tu proyecto: `myword-67b03`
3.  En el menú lateral izquierdo, busca la sección "Build" (Compilación) y haz clic en **App Check**.
4.  Ve a la pestaña **APIs** (o "Apps").
5.  Busca la lista de servicios protegidos (Cloud Firestore, Cloud Storage, Cloud Functions).
6.  Haz clic en cada uno y cambia el estado de "Enforced" (Forzado) a **Unenforced** (No forzado) o **Monitor**.
    -   Esto permitirá que las peticiones pasen aunque el Token de App Check falte o sea inválido.
7.  Espera unos minutos a que se propague el cambio.

4. RECOMENDACIÓN A FUTURO
--------------------------------------------------------------------------------
-   **Debug Tokens:** Para desarrollo local (`localhost`), configura un "Debug Token" en App Check para evitar quemar la cuota de ReCaptcha y evitar estos bloqueos.
-   **Lista Blanca:** Asegúrate de que el dominio donde estás probando la app esté autorizado en la configuración de ReCaptcha v3 (Google Cloud Console -> APIs & Services -> Credentials).

Estado: La corrección de código (código defensivo) ya está aplicada en la rama `fix-oom-auth-error`, pero el desbloqueo real requiere la acción manual en la consola descrita arriba.
