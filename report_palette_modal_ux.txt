REPORTE DE CAMBIOS - PALETTE UX IMPROVEMENTS
============================================

1. QUÉ SE HIZO (WHAT)
---------------------
- Se mejoró el componente `src/components/ui/Modal.tsx` para incluir estándares modernos de UX y accesibilidad.
  - Implementación de "Click Outside to Close": Ahora se puede cerrar el modal haciendo clic en el fondo oscuro (backdrop).
  - Gestión de Foco (Focus Management): Al abrirse, el modal captura automáticamente el foco del teclado. Esto es crucial para usuarios que navegan con teclado o lectores de pantalla.
  - Se añadió `tabIndex={-1}` al contenedor del contenido para permitir que reciba foco programáticamente.
  - Se añadió `e.stopPropagation()` al contenedor interno para evitar que los clics dentro del modal lo cierren accidentalmente.

- Se corrigió un error en `src/components/director/chat/ChatMessage.tsx`.
  - El componente `ReactMarkdown` estaba recibiendo la propiedad `className`, lo cual ya no es soportado en las versiones recientes (v9+) y causaba errores en la consola (y potencialmente en la UI) durante las pruebas.
  - Se movieron las clases de estilo (`prose`, `prose-invert`, etc.) a un `div` contenedor que envuelve al componente `ReactMarkdown`.

2. POR QUÉ (WHY)
----------------
- **Accesibilidad (A11y):** Los modales que no gestionan el foco son "trampas" para los usuarios de teclado, que pueden seguir tabulando elementos detrás del modal sin darse cuenta.
- **Usabilidad (UX):** El patrón de "clic afuera para cerrar" es un estándar esperado por la mayoría de los usuarios web. Su ausencia crea fricción.
- **Estabilidad:** La corrección en `ChatMessage` elimina "ruido" en la consola y previene comportamientos inesperados de renderizado debido a props inválidas.

3. PROBLEMAS ENCONTRADOS
------------------------
- **Verificación con Playwright:** Inicialmente, el script de verificación fallaba al intentar conectar con el puerto `5173` (puerto por defecto de Vite). Se tuvo que ajustar el script para usar el puerto `3000`, que es el configurado explícitamente en `vite.config.ts`.
- **Error de Runtime ReactMarkdown:** Durante la ejecución del script de verificación (que captura logs de consola), se detectaron errores repetitivos: `Unexpected className prop`. Esto bloqueaba la visión clara de otros problemas y señalaba una deuda técnica que debía resolverse antes de considerar el trabajo "terminado".
- **Entorno de Pruebas:** La falta de scripts de prueba estandarizados (`pnpm test`) requirió la creación de un script `verify_modal.py` ad-hoc y la instalación manual de dependencias de prueba (`playwright`) en el entorno volátil.

4. NOTAS ADICIONALES
--------------------
- Se recomienda revisar otros usos de `ReactMarkdown` en el proyecto para asegurar que no se esté pasando `className` incorrectamente en otros lugares.
- La implementación actual del Modal es robusta, pero en el futuro podría beneficiarse de un "Focus Trap" completo (que impida que el foco salga del modal mientras esté abierto), aunque el auto-foco inicial es un gran primer paso (80/20 rule).
- Se ha verificado visualmente mediante capturas de pantalla que el modal se abre y se cierra correctamente con las nuevas interacciones.
